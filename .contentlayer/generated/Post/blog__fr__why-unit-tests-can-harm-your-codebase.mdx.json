{
  "title": "Pourquoi les Tests Unitaires Peuvent Nuire à Votre Codebase et Empêcher le Refactoring",
  "date": "2024-11-15T00:00:00.000Z",
  "language": "fr",
  "category": "Development",
  "image": "/images/articles/unit-test.jpg",
  "description": "Découvrez pourquoi sur-tester les méthodes intermédiaires peut mener à un code rigide et comment prendre de meilleures décisions sur ce qu'il faut tester.",
  "timeToRead": 4,
  "alternates": {
    "en": "why-unit-tests-can-harm-your-codebase",
    "fr": "why-unit-tests-can-harm-your-codebase"
  },
  "body": {
    "raw": "\nEn tant que développeurs, nous entendons souvent que plus de tests égalent une meilleure qualité de code. Cependant, il y a un piège caché dans cette pensée qui peut mener à des codebases inflexibles et rendre le refactoring presque impossible. Explorons pourquoi certains tests unitaires peuvent en fait nuire à votre codebase et comment éviter ces pièges.\n\n## Le Problème du Sur-Testing\n\nPlus vous testez les méthodes intermédiaires - celles qui ne sont pas des points d'entrée à votre logique métier - plus votre code devient rigide. Mais pourquoi cela arrive-t-il ?\n\n```javascript\n// Exemple d'une méthode intermédiaire qui ne devrait pas nécessairement être testée\nconst calculateSubTotal = (items) => {\n  return items.reduce((sum, item) => sum + item.price, 0)\n}\n\n// Ceci est le vrai point d'entrée de la logique métier qui devrait être testé\nconst calculateFinalPrice = (items, discountCode) => {\n  const subTotal = calculateSubTotal(items)\n  const discount = applyDiscount(subTotal, discountCode)\n  return subTotal - discount\n}\n```\n\nQuand vous écrivez des tests pour `calculateSubTotal`, vous cimentez essentiellement son implémentation. Tout refactoring futur qui voudrait combiner ou diviser cette logique différemment nécessiterait de changer les tests, même si le comportement final reste le même.\n\n## Quand Devriez-Vous Écrire des Tests ?\n\nAvant d'écrire un test, posez-vous ces questions cruciales :\n\n1. **Cette méthode est-elle déjà couverte par des tests de plus haut niveau ?**\n\n   - Si votre méthode de point d'entrée teste déjà cette fonctionnalité, des tests supplémentaires pourraient être redondants\n\n2. **Cette méthode est-elle un point d'entrée crucial ?**\n\n   - Concentrez-vous sur tester l'API publique de vos modules\n\n3. **Cela fait-il partie du contrat de votre application ?**\n   - Testez les comportements dont d'autres parties de votre système dépendent\n\n## Meilleures Stratégies de Test\n\nAu lieu de tout tester, concentrez-vous sur :\n\n```javascript\n// TESTEZ les endpoints d'API publique\ndescribe('OrderService', () => {\n  it('should calculate final price with discount', () => {\n    const items = [{ price: 100 }, { price: 200 }]\n    const result = orderService.calculateFinalPrice(items, 'DISCOUNT10')\n    expect(result).toBe(270) // Teste le résultat métier final\n  })\n})\n\n// NE TESTEZ PAS les détails d'implémentation privés\n// évitez de tester calculateSubTotal() directement\n```\n\n## L'Impact sur le Refactoring\n\nQuand vous sur-testez, le refactoring devient difficile parce que :\n\n1. Chaque changement interne nécessite de mettre à jour plusieurs tests\n2. La maintenance des tests devient un surcoût significatif\n3. Les développeurs deviennent réticents à faire des changements nécessaires\n\n## Bonnes Pratiques pour un Testing Durable\n\nPour maintenir une codebase saine :\n\n- Testez les comportements, pas les implémentations\n- Concentrez-vous sur les points d'entrée et les APIs publiques\n- Gardez les implémentations internes flexibles\n- Écrivez des tests qui supportent le refactoring, ne l'empêchent pas\n\n## Conclusion\n\nBien que le testing soit crucial pour maintenir la qualité du code, le sur-testing peut être tout aussi nuisible que le sous-testing. En se concentrant sur tester les bonnes choses - points d'entrée, APIs publiques, et logique métier cruciale - vous pouvez maintenir une suite de tests robuste qui vérifie le comportement de votre application tout en permettant le refactoring et les améliorations futures.\n\nRappelez-vous : L'objectif du testing est de s'assurer que votre application fonctionne correctement, pas de documenter chaque détail d'implémentation interne. Faites en sorte que vos tests travaillent pour vous, pas contre vous.\n",
    "code": "var Component=(()=>{var p=Object.create;var c=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var h=Object.getPrototypeOf,k=Object.prototype.hasOwnProperty;var N=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),v=(t,e)=>{for(var s in e)c(t,s,{get:e[s],enumerable:!0})},r=(t,e,s,i)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let a of m(e))!k.call(t,a)&&a!==s&&c(t,a,{get:()=>e[a],enumerable:!(i=d(e,a))||i.enumerable});return t};var g=(t,e,s)=>(s=t!=null?p(h(t)):{},r(e||!t||!t.__esModule?c(s,\"default\",{value:t,enumerable:!0}):s,t)),f=t=>r(c({},\"__esModule\",{value:!0}),t);var o=N((z,l)=>{l.exports=_jsx_runtime});var T={};v(T,{default:()=>y,frontmatter:()=>b});var n=g(o()),b={date:\"2024-11-15\",language:\"fr\",title:\"Pourquoi les Tests Unitaires Peuvent Nuire \\xE0 Votre Codebase et Emp\\xEAcher le Refactoring\",category:\"Development\",image:\"/images/articles/unit-test.jpg\",description:\"D\\xE9couvrez pourquoi sur-tester les m\\xE9thodes interm\\xE9diaires peut mener \\xE0 un code rigide et comment prendre de meilleures d\\xE9cisions sur ce qu'il faut tester.\",timeToRead:4,alternates:{en:\"why-unit-tests-can-harm-your-codebase\",fr:\"why-unit-tests-can-harm-your-codebase\"}};function u(t){let e=Object.assign({p:\"p\",h2:\"h2\",pre:\"pre\",code:\"code\",span:\"span\",ol:\"ol\",li:\"li\",strong:\"strong\",ul:\"ul\"},t.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.p,{children:\"En tant que d\\xE9veloppeurs, nous entendons souvent que plus de tests \\xE9galent une meilleure qualit\\xE9 de code. Cependant, il y a un pi\\xE8ge cach\\xE9 dans cette pens\\xE9e qui peut mener \\xE0 des codebases inflexibles et rendre le refactoring presque impossible. Explorons pourquoi certains tests unitaires peuvent en fait nuire \\xE0 votre codebase et comment \\xE9viter ces pi\\xE8ges.\"}),`\n`,(0,n.jsx)(e.h2,{children:\"Le Probl\\xE8me du Sur-Testing\"}),`\n`,(0,n.jsx)(e.p,{children:\"Plus vous testez les m\\xE9thodes interm\\xE9diaires - celles qui ne sont pas des points d'entr\\xE9e \\xE0 votre logique m\\xE9tier - plus votre code devient rigide. Mais pourquoi cela arrive-t-il ?\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-javascript\",children:(0,n.jsxs)(e.code,{className:\"language-javascript\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// Exemple d'une m\\xE9thode interm\\xE9diaire qui ne devrait pas n\\xE9cessairement \\xEAtre test\\xE9e\"}),`\n`,(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,n.jsx)(e.span,{className:\"token function-variable function\",children:\"calculateSubTotal\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token parameter\",children:\"items\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token arrow operator\",children:\"=>\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n  `,(0,n.jsx)(e.span,{className:\"token keyword control-flow\",children:\"return\"}),\" items\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"reduce\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token parameter\",children:[\"sum\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" item\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token arrow operator\",children:\"=>\"}),\" sum \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" item\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"price\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`,(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n\n`,(0,n.jsx)(e.span,{className:\"token comment\",children:\"// Ceci est le vrai point d'entr\\xE9e de la logique m\\xE9tier qui devrait \\xEAtre test\\xE9\"}),`\n`,(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,n.jsx)(e.span,{className:\"token function-variable function\",children:\"calculateFinalPrice\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token parameter\",children:[\"items\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" discountCode\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token arrow operator\",children:\"=>\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n  `,(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" subTotal \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"calculateSubTotal\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"items\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n  `,(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" discount \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"applyDiscount\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"subTotal\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" discountCode\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n  `,(0,n.jsx)(e.span,{className:\"token keyword control-flow\",children:\"return\"}),\" subTotal \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),` discount\n`,(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Quand vous \\xE9crivez des tests pour \",(0,n.jsx)(e.code,{children:\"calculateSubTotal\"}),\", vous cimentez essentiellement son impl\\xE9mentation. Tout refactoring futur qui voudrait combiner ou diviser cette logique diff\\xE9remment n\\xE9cessiterait de changer les tests, m\\xEAme si le comportement final reste le m\\xEAme.\"]}),`\n`,(0,n.jsx)(e.h2,{children:\"Quand Devriez-Vous \\xC9crire des Tests ?\"}),`\n`,(0,n.jsx)(e.p,{children:\"Avant d'\\xE9crire un test, posez-vous ces questions cruciales :\"}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsxs)(e.li,{children:[`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:\"Cette m\\xE9thode est-elle d\\xE9j\\xE0 couverte par des tests de plus haut niveau ?\"})}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Si votre m\\xE9thode de point d'entr\\xE9e teste d\\xE9j\\xE0 cette fonctionnalit\\xE9, des tests suppl\\xE9mentaires pourraient \\xEAtre redondants\"}),`\n`]}),`\n`]}),`\n`,(0,n.jsxs)(e.li,{children:[`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:\"Cette m\\xE9thode est-elle un point d'entr\\xE9e crucial ?\"})}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Concentrez-vous sur tester l'API publique de vos modules\"}),`\n`]}),`\n`]}),`\n`,(0,n.jsxs)(e.li,{children:[`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:\"Cela fait-il partie du contrat de votre application ?\"})}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Testez les comportements dont d'autres parties de votre syst\\xE8me d\\xE9pendent\"}),`\n`]}),`\n`]}),`\n`]}),`\n`,(0,n.jsx)(e.h2,{children:\"Meilleures Strat\\xE9gies de Test\"}),`\n`,(0,n.jsx)(e.p,{children:\"Au lieu de tout tester, concentrez-vous sur :\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-javascript\",children:(0,n.jsxs)(e.code,{className:\"language-javascript\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// TESTEZ les endpoints d'API publique\"}),`\n`,(0,n.jsx)(e.span,{className:\"token function\",children:\"describe\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'OrderService'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token arrow operator\",children:\"=>\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n  `,(0,n.jsx)(e.span,{className:\"token function\",children:\"it\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"'should calculate final price with discount'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token arrow operator\",children:\"=>\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n    `,(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" items \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" \",(0,n.jsx)(e.span,{className:\"token literal-property property\",children:\"price\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"100\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" \",(0,n.jsx)(e.span,{className:\"token literal-property property\",children:\"price\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"200\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n    `,(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" result \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" orderService\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"calculateFinalPrice\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"items\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'DISCOUNT10'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n    `,(0,n.jsx)(e.span,{className:\"token function\",children:\"expect\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"result\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token method function property-access\",children:\"toBe\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"270\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// Teste le r\\xE9sultat m\\xE9tier final\"}),`\n  `,(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`,(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n\n`,(0,n.jsx)(e.span,{className:\"token comment\",children:\"// NE TESTEZ PAS les d\\xE9tails d'impl\\xE9mentation priv\\xE9s\"}),`\n`,(0,n.jsx)(e.span,{className:\"token comment\",children:\"// \\xE9vitez de tester calculateSubTotal() directement\"}),`\n`]})}),`\n`,(0,n.jsx)(e.h2,{children:\"L'Impact sur le Refactoring\"}),`\n`,(0,n.jsx)(e.p,{children:\"Quand vous sur-testez, le refactoring devient difficile parce que :\"}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Chaque changement interne n\\xE9cessite de mettre \\xE0 jour plusieurs tests\"}),`\n`,(0,n.jsx)(e.li,{children:\"La maintenance des tests devient un surco\\xFBt significatif\"}),`\n`,(0,n.jsx)(e.li,{children:\"Les d\\xE9veloppeurs deviennent r\\xE9ticents \\xE0 faire des changements n\\xE9cessaires\"}),`\n`]}),`\n`,(0,n.jsx)(e.h2,{children:\"Bonnes Pratiques pour un Testing Durable\"}),`\n`,(0,n.jsx)(e.p,{children:\"Pour maintenir une codebase saine :\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Testez les comportements, pas les impl\\xE9mentations\"}),`\n`,(0,n.jsx)(e.li,{children:\"Concentrez-vous sur les points d'entr\\xE9e et les APIs publiques\"}),`\n`,(0,n.jsx)(e.li,{children:\"Gardez les impl\\xE9mentations internes flexibles\"}),`\n`,(0,n.jsx)(e.li,{children:\"\\xC9crivez des tests qui supportent le refactoring, ne l'emp\\xEAchent pas\"}),`\n`]}),`\n`,(0,n.jsx)(e.h2,{children:\"Conclusion\"}),`\n`,(0,n.jsx)(e.p,{children:\"Bien que le testing soit crucial pour maintenir la qualit\\xE9 du code, le sur-testing peut \\xEAtre tout aussi nuisible que le sous-testing. En se concentrant sur tester les bonnes choses - points d'entr\\xE9e, APIs publiques, et logique m\\xE9tier cruciale - vous pouvez maintenir une suite de tests robuste qui v\\xE9rifie le comportement de votre application tout en permettant le refactoring et les am\\xE9liorations futures.\"}),`\n`,(0,n.jsx)(e.p,{children:\"Rappelez-vous : L'objectif du testing est de s'assurer que votre application fonctionne correctement, pas de documenter chaque d\\xE9tail d'impl\\xE9mentation interne. Faites en sorte que vos tests travaillent pour vous, pas contre vous.\"})]})}function q(t={}){let{wrapper:e}=t.components||{};return e?(0,n.jsx)(e,Object.assign({},t,{children:(0,n.jsx)(u,t)})):u(t)}var y=q;return f(T);})();\n;return Component;"
  },
  "_id": "blog/fr/why-unit-tests-can-harm-your-codebase.mdx",
  "_raw": {
    "sourceFilePath": "blog/fr/why-unit-tests-can-harm-your-codebase.mdx",
    "sourceFileName": "why-unit-tests-can-harm-your-codebase.mdx",
    "sourceFileDir": "blog/fr",
    "contentType": "mdx",
    "flattenedPath": "blog/fr/why-unit-tests-can-harm-your-codebase"
  },
  "type": "Post",
  "url": "/fr/blog/why-unit-tests-can-harm-your-codebase",
  "slug": "why-unit-tests-can-harm-your-codebase"
}